Create new documents with the user connected

- [Instructor] Something you want to also enable is to allow automatic sign-in. So we also want to manage users so they can be automatically signed in. So I'm going to add this first in our, so whenever we defined the handler functions for the SDK, right here. And this one I'm going to set up right here, and I'm going to call it, this function, I'm going to call get current user. So we're going to set this one up too, this is going to return also a promise. And basically we're going to do that with the auth objects and call this function, which is on auth state changed. And we're going to pass resolve because whichever results we get from this on auth state change, we're going to pass this like when we return the promise. And let's go back to our context object right here. So we are going to add this one which is authenticate. Now, I want to name it, yeah, it's going to be get current user. And then here, I'm going to name my function authenticate. And then basically it's going to be very simple. We're going to do get current user, and inside the promise, we're going to do set current user. Then we're going to update. So the value of current user when we start the app. And so this is when, I'm going to do that right here, so at the same place, you know, where we read allow to update right away. The information of that's going to be from the context. We're going to make sure to add use auth context. And from here, we add to the scope with use auth context, this function, authenticate. And let's make sure that we actually, like here, we update with authenticate as well. Here we go. Let's go back, and then we're going to then update, and as soon as we start the app, if we are connected, but if you are logged out, it's not going to work. But here we go. So now it works. So now you can see that it automatically authenticated the user. I'm going to change accounts. So I'd like to show you the avatar just to show you that this is working. I'm going to try with another account. And basically, so now that we have, like, we have the assurance that we're going to stay connected, like when I check right here, like so, you see that now you can see the avatar. So this is working like as expected, all right? And at some point we're going to be able to see it. So for now, so what I want to also update is whenever you add a new document, we're going to go in the upload form and also add to the scope, so this, by using use auth context. Here we go. And right here. So it's going to be current user. And now this time it's going to be magic because now you can also provide with the information of the user, and we're going to do that with current user. And I think that we're going to specify, it's better to specify, like, the name. And instead of just doing the name, we're going to do some sort of username, maybe. Instead of just doing, we're going to do, I'm going to add a use memo. I'm going to do that right here, username. And it's going to be this, whatever we get back. We're going to do split because it's going to be a space. And we're going to join again, and we're going to do also lowercase, to lowercase, like this and then join. And then I'm going to pass this as the value of username. There we go. Let's try that. So when we add a new, so let's go back. Current user, upload line 33, current user. Okay, I missed also the part to actually add this to the scope. So it's going to be use auth context, and that's going to be current user. Like so. Let's see if there's anything missing maybe. Okay, let's try it. I'm going to inspect. Oh, okay. I think I just have like an issue going on right here, to lowercase. Let's change that to, I'm going to do to lowercase right here from here. It's going to make more sense. Okay, so let's go back and try that. So I'm going to say new image from, I'm going to say Sandy L because this is my username right here. I'm going to upload a new one, new image, like this. Okay, let's just hit save and upload, and here we go. So now you can see new image from Sandy L. The only thing we need to update also is that because we haven't updated our card component, so we're going to do that as well at the same time that we update the security rules.